---

 - hosts: localhost
   remote_user: root
   vars:
     - adminremove_passwords: True
     - adminusers:
       - {name: admin1, state: 'present', uid: 5001, group: "{{admingroup}}", shell: "{{adminshell}}", pubkey: "ssh-rsa KEY admin1@example.com" }
       - {name: admin2, state: 'present', uid: 5002, group: "{{admingroup}}", shell: "{{adminshell}}", pubkey: "ssh-rsa KEY admin2@example.com", groups: "agroup" }
       - {name: admin3, state: 'present', uid: 5003, groups: "{{admingroup}}", shell: "{{adminshell}}", pubkey: "ssh-rsa KEY admin3@example.com" }
       - {name: admin4, state: 'present', uid: 5004, group: "{{admingroup}}", shell: "{{adminshell}}", pubkey: "ssh-rsa KEY admin4@example.com", groups: "bgroup" }
     - moreusers:
       - {name: user1, state: 'present', uid: 6001, shell: "{{adminshell}}" }
       - {name: user2, state: 'present', uid: 6002 }
       - {name: user3, state: 'absent', uid: 6003 }
       - {name: user4, state: 'absent', uid: 6004, pubkey: "ssh-rsa KEY user4@example.com" }
       - {name: user5, state: 'present', uid: 6005, pubkey: "ssh-rsa KEY5 user5@example.com" }
       - {name: user6, state: 'present', uid: 6006, pubkey: "ssh-rsa KEY6 user6@example.com", options: 'command="/usr/local/bin/rrsync /allow/rrsync/here/directory",no-agent-forwarding,no-port-forwarding,no-pty,no-user-rc,no-X11-forwarding' }
       - {name: user7, state: 'absent', uid: 6007, pubkey: "ssh-rsa KEY6 user6@example.com", options: 'command="/usr/local/bin/rrsync /allow/rrsync/here/directory",no-agent-forwarding,no-port-forwarding,no-pty,no-user-rc,no-X11-forwarding' }
     - admin_root_keys:
       - { state: 'present', pubkey: "ssh-rsa KEY admin1@example.com" }
       - { state: 'absent', pubkey: "ssh-rsa KEY2 bad_admin2@example.com" }
     - admin_list_of_groups:
       - { name: agroup, gid: 27001 }
       - { name: bgroup, gid: 27002 }
     
   roles:
     - ansible-role-users
